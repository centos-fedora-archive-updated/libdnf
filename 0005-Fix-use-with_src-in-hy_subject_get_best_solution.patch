From 557409d8a49449d4424d0fe5c919fbc0c1c26d73 Mon Sep 17 00:00:00 2001
From: Jaroslav Rohel <jrohel@redhat.com>
Date: Thu, 7 Nov 2019 09:53:54 +0100
Subject: [PATCH] Fix: use with_src in hy_subject_get_best_solution()

The code accidentally disappeared during improving getBestSolution().
---
 libdnf/hy-subject.cpp | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/libdnf/hy-subject.cpp b/libdnf/hy-subject.cpp
index 686438d..c90fa14 100644
--- a/libdnf/hy-subject.cpp
+++ b/libdnf/hy-subject.cpp
@@ -81,6 +81,8 @@ hy_subject_get_best_solution(HySubject subject, DnfSack *sack, HyForm *forms, Hy
                              gboolean with_filenames, gboolean with_src)
 {
     std::unique_ptr<libdnf::Query> query(new libdnf::Query(sack, libdnf::Query::ExcludeFlags::APPLY_EXCLUDES));
+    if (!with_src)
+        query->addFilter(HY_PKG_ARCH, HY_NEQ, "src");
     auto ret = query->filterSubject(subject, forms, icase, with_nevra, with_provides, with_filenames);
     *out_nevra = ret.second.release();
     return query.release();
--
libgit2 0.28.2

